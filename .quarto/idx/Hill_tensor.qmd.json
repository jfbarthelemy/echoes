{"title":"Hill polarization tensor","markdown":{"headingText":"Hill polarization tensor","containsRefs":false,"markdown":"::: {.content-visible unless-format=\"pdf\"}\n::: {.hidden}\n$$\n{{< include config/_macros.tex >}}\n$$\n:::\n:::\n\n\nThis section recalls some results about the calculation of the Hill polarization tensors related to a matrix of stiffness $\\mathbb{C}$ and an ellipsoid $\\mathcal{E}_{\\uu{A}}$ of equation\n$$\n\\uv{x}\\in\\mathcal{E}_{\\uu{A}}\n\\quad\\Leftrightarrow\\quad\n\\uv{x}\\cdot(\\trans{\\uu{A}}\\cdot\\uu{A})^{-1}\\cdot\\uv{x}\\leq 1\n$$\nwhere $\\uu{A}$ is an invertible second-order tensor so that $\\trans{\\uu{A}}\\cdot\\uu{A}$ is a positive definite symmetric tensor associated to 3 radii (eigenvalues $a\\geq b \\geq c$ possibly written $\\rho_1 \\geq \\rho_2 \\geq \\rho_3$ for convenience) and 3 angles (orientation of the frame of eigenvectors $\\uv{e}_1, \\uv{e}_2, \\uv{e}_3$)\n$$\n\\trans{\\uu{A}}\\cdot\\uu{A}=a^2 \\uv{e}_1\\otimes\\uv{e}_1 + b^2 \\uv{e}_2\\otimes\\uv{e}_2 + c^2 \\uv{e}_3\\otimes\\uv{e}_3 = \\sum_{i=1}^3 \\rho_i \\uv{e}_i\\otimes\\uv{e}_i\n$${#eq-ellipsoid}\n\n## General expression\n\nA general expression of the elastic polarization tensor is derived in [@willis1977] (see also [@mura1987])\n$$\\begin{aligned}\n\\uuuu{P}(\\uu{A},\\uuuu{C})&=\\frac{1}{4\\pi}\n\\int_{\\norm{\\uv{\\zeta}}=1}\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\\sotimes\n\\Big((\\uu{A}^{-1}\\cdot\\uv{\\zeta})\\cdot\\uuuu{C}\n\\cdot(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\\Big)^{-1}\n\\sotimes(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n\\ud S_\\zeta\\\\\n&=\n\\frac{\\det{\\uu{A}}}{4\\pi}\n\\int_{\\norm{\\uv{\\xi}}=1}\n\\frac{\\uv{\\xi}\\sotimes\n(\\uv{\\xi}\\cdot\\uuuu{C}\n\\cdot\\uv{\\xi})^{-1}\n\\sotimes\\uv{\\xi}}{\\norm{\\uu{A}\\cdot\\uv{\\xi}}^3}\n\\ud S_{\\xi}\n\\end{aligned}$${#eq-Hill}\n\nWhen $\\uuuu{C}$ is arbitrarily anisotropic, it is necessary to resort to numerical cubature to estimate $\\uuuu{P}$ as proposed in [@ghahremani1977], [@gavazzi1990] or [@masson2008]. However in some cases of anisotropy, analytical solutions are available ([@withers1989], [@barthelemy2020]). The case of isotropic matrix is particularly developed in the next section.\n\n## Isotropic matrix\n\nIn this section, the matrix is assumed isotropic so that its stiffness tensor writes by means of a bulk $k$ and shear $\\mu$ or Lamé $\\lambda$ and $\\mu$ moduli or even Young modulus $E$ and Poisson ratio $\\nu$ with $k=\\frac{E}{3(1-2\\nu)}$ and $\\mu=\\frac{E}{2(1+\\nu)}$.\n$$\\begin{aligned}\n\\uuuu{C} =& {} 3k\\uuuu{J}+2\\mu\\uuuu{K} =  3\\lambda\\uuuu{I}+2\\mu\\uuuu{K}\\\\\n & \\quad\\textrm{with}\\quad J_{ijkl}=\\frac{\\delta_{ij}\\delta_{kl}}{3},\nI_{ijkl}=\\frac{\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}}{2}\n\\textrm{ and }\n\\uuuu{K}=\\uuuu{I}-\\uuuu{J}\n\\end{aligned}$${#eq-isoC}\n\nIntroducing @eq-isoC in @eq-Hill leads to after some algebra\n$$\n\\uuuu{P}=\n\\frac{1}{\\lambda+2\\,\\mu}\n\\uuuu{U}\n+\\frac{1}{\\mu}(\\uuuu{V}-\\uuuu{U})\n$$\nwhere the tensors $\\uuuu{U}$ and $\\uuuu{V}$, depending only on the ellipsoidal\ntensor $\\uu{A}$ of [@eq-ellipsoid], are given by (see [@barthelemy2020])\n$$\\begin{aligned}\n\\uuuu{U} &= \\frac{\\det{\\uu{A}}}{4\\pi}\n\\int_{\\norm{\\uv{\\xi}}=1}\n\\frac{\\uv{\\xi}\\otimes\\uv{\\xi}\\otimes\\uv{\\xi}\\otimes\\uv{\\xi}}\n{\\norm{\\uu{A}\\cdot\\uv{\\xi}}^3}\\ud S_{\\xi}\\\\\n&=\n\\frac{1}{4\\pi}\n\\int_{\\norm{\\uv{\\zeta}}=1}\n\\frac{%\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n\\otimes\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n\\otimes\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n\\otimes\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n}{\\norm{\\uu{A}^{-1}\\cdot\\uv{\\zeta}}^4}\n\\ud S_{\\zeta}\n\\end{aligned}$$\nand\n$$\\begin{aligned}\n\\uuuu{V} &= \\frac{\\det{\\uu{A}}}{4\\pi}\n\\int_{\\norm{\\uv{\\xi}}=1}\n\\frac{\\uv{\\xi}\\sotimes\\uu{1}\\sotimes\\uv{\\xi}}\n{\\norm{\\uu{A}\\cdot\\uv{\\xi}}^3}\\ud S_{\\xi}\\\\\n&=\n\\frac{1}{4\\pi}\n\\int_{\\norm{\\uv{\\zeta}}=1}\n\\frac{%\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n\\sotimes\n\\uu{1}\n\\sotimes\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n}{\\norm{\\uu{A}^{-1}\\cdot\\uv{\\zeta}}^2}\n\\ud S_{\\zeta}\n\\end{aligned}$$\nFor an arbitrary ellipsoid defined by @eq-ellipsoid, the components of $\\uuuu{U}$ and $\\uuuu{V}$ write\n$$\\begin{aligned}\nU_{iiii}&=\\frac{3(I_i-\\rho_i^2I_{ii})}{2} \n\\quad\\forall\\, i\\in\\{1,2,3\\}\\\\\nU_{iijj}=U_{ijij}=U_{ijji}&=\\frac{I_j-\\rho_i^2I_{ij}}{2} \n=\\frac{I_i-\\rho_j^2I_{ij}}{2}\n\\quad\\forall\\, i\\neq j\\in\\{1,2,3\\}\n\\end{aligned}$$\nand\n$$\\begin{aligned}\nV_{iiii}&=I_i\\quad\\forall\\, i\\in\\{1,2,3\\}\\\\\nV_{ijij}=V_{ijji}&=\\frac{I_i+I_j}{4}\n\\quad\\forall\\, i\\neq j\\in\\{1,2,3\\}\n\\end{aligned}$$\nwhere the coefficients $I_i$ and $I_{ij}$ are given by\n(note that $I_i$ and $I_{ij}$ are adapted from those provided in\n[@kellogg1929]\nand [@eshelby1957]:\nthey differ by a factor of $4\\pi/3$\nfor $I_{ij}$ with $i\\neq j$ and by $4\\pi$ for the others)\n\n- if $a > b > c$\n    $$\\begin{aligned}\n    I_1&=\\frac{a\\,b\\,c}{(a^2-b^2)\\sqrt{a^2-c^2}}\\,\n    \\left({\\cal F}-{\\cal E}\\right)\\\\\n    I_3&=\\frac{a\\,b\\,c}{(b^2-c^2)\\sqrt{a^2-c^2}}\\,\n    \\left(\\frac{b\\sqrt{a^2-c^2}}{a\\,c}-\n    {\\cal E}\\right)\\\\\n    I_2&=1-I_1-I_3\\\\\n    I_{ij}&=\\frac{I_j-I_i}{\\rho_i^2-\\rho_j^2}\\quad\\forall\\, i\\neq j\\in\\{1,2,3\\}\\\\\n    I_{ii}&=\\frac{1}{3}\\left(\n    \\frac{1}{\\rho_i^2}-\n    \\sum_{j\\neq i}I_{ij} \\right) \n    \\quad\\forall\\, i\\in\\{1,2,3\\}\n    \\end{aligned}$$  \n    where ${\\cal F}={\\cal F}(\\theta,\\kappa)$ and\n    ${\\cal E}={\\cal E}(\\theta,\\kappa)$\n    are respectively the elliptic integrals of the first and second\n    kinds (see [@abramowitz1972]) of amplitude and parameter\n    $$\n    \\theta=\\arcsin{\\sqrt{1-\\frac{c^2}{a^2}}}\n    \\quad;\\quad\n    \\kappa=\\sqrt{\\frac{a^2-b^2}{a^2-c^2}}\n    $$\n- if $a > b = c$ (prolate spheroid)\n    $$\\begin{aligned}\n    I_2=I_3&=a\\,\n    \\frac{a\\sqrt{a^2-c^2}-c^2\\,\\arcosh{(a/c)}}\n    {2\\left(a^2-c^2\\right)^{3/2}}\\\\\n    I_1&=1-2\\,I_3\\\\\n    I_{1i}=I_{i1}&=\\frac{I_i-I_1}{a^2-\\rho_i^2}\\quad\n    \\forall\\, i\\in\\{2,3\\}\\\\\n    I_{ij}&=\\frac{1}{4}\n    \\left(\\frac{1}{c^2}-I_{31} \\right) \n    \\quad\\forall\\, i,j\\in\\{2,3\\}\\\\\n    I_{11}&=\\frac{1}{3}\n    \\left(\\frac{1}{a^2}-2\\,I_{31} \\right)\n    \\end{aligned}$$\n- if $a = b > c$ (oblate spheroid)\n    $$\\begin{aligned}\n    I_1=I_2&=c\\,\n    \\frac{a^2\\,\\arccos{(c/a)}-c\\sqrt{a^2-c^2}}\n    {2\\left(a^2-c^2\\right)^{3/2}}\\\\\n    I_3&=1-2\\,I_1\\\\\n    I_{3i}=I_{i3}&=\\frac{I_3-I_i}{\\rho_i^2-c^2}\\quad\n    \\forall\\, i\\in\\{1,2\\}\\\\\n    I_{ij}&=\\frac{1}{4}\n    \\left(\\frac{1}{a^2}-I_{31} \\right) \n    \\quad\\forall\\, i,j\\in\\{1,2\\}\\\\\n    I_{33}&=\\frac{1}{3}\n    \\left(\\frac{1}{c^2}-2\\,I_{31} \\right)\n    \\end{aligned}$$\n- if $a = b = c$ (sphere)\n    $$\\begin{aligned}\n    I_1=I_2=I_3&=\\frac{1}{3}\\\\\n    I_{ij}&=\\frac{1}{5\\,a^2}\\quad\\forall\\, i,j\\in\\{1,2,3\\}\n    \\end{aligned}$$\n\nIn this last case of spherical inclusion ($\\uu{A}=\\uu{1}$), $\\uuuu{U}$ and $\\uuuu{V}$ are simply decomposed as\n$$\n\\uuuu{U}=\\frac{1}{3}\\uuuu{J}+\\frac{2}{15}\\uuuu{K}\n\\quad\\textrm{ and }\\quad\n\\uuuu{V}=\\frac{1}{3}\\uuuu{I}\n$$\n\n## Case of cracks\n\nThe case of cracks corresponds to ellipsoids for which the smallest radius is very small compared to the two others, in other words the characteristic tensor $\\uu{A}$ @eq-ellipsoid can be written here\n$$\n\\uu{A}=\n\\uv{\\ell}\\otimes\\uv{\\ell}+\n\\eta\\,\\uv{m}\\otimes\\uv{m}+\n\\omega\\,\\uv{n}\\otimes\\uv{n}\n\\quad\\textrm{with}\\quad\n\\eta=\\frac{b}{a}\n\\quad\\textrm{and}\\quad\n\\omega=\\frac{c}{a}\n$$\n<!-- <p>\n<a id=\"fig-ellipsoidalcrack\"></a>\n<center>\n<img align=\"middle\" width=\"30%\" alt=\"Ellipsoidal crack\" src=\"./ellipsoidalcrack.png\">\n<figcaption>Ellipsoidal crack</figcaption>\n</p> -->\n<!-- ![Ellipsoidal crack](ellipsoidal.tex){#fig-crack0} -->\n\n::: {#fig-crack}\n\n![](images/ellipsoidalcrack){width=50%}\n\nEllipsoidal crack\n:::\n\nIn the case of cracks, it is useful to introduce the second Hill polarization tensor defined as\n$$\n\\uuuu{Q}=\\uuuu{C}-\\uuuu{C}:\\uuuu{P}:\\uuuu{C}\n$$\nand in particular $\\lim_{\\omega\\to 0}\\omega\\,\\uuuu{Q}^{-1}$\nin which it is recalled that $\\uuuu{P}$ and thus $\\uuuu{Q}$ depend on $\\omega$ such that the components $Q_{nijk}$ (with $n$ corresponding to the crack normal) behave as $1/\\omega$ when $\\omega$ tends towards $0$. The analytical expressions of this limit are fully detailed in [@barthelemy2021] which recalls in particular that $\\uuuu{L}$ actually derives from a symmetric second-order tensor $\\uu{B}$ as\n$$\n\\uuuu{L}=\n\\lim_{\\omega\\to 0} \\omega\\,\\uuuu{Q}^{-1}\n=\\frac{3}{4}\\,\\uv{n}\\sotimes\\uu{B}\\sotimes\\uv{n}\n$${#eq-L}\n\nFor an arbitrarly anisotropic matrix, an algorithm allowing to estimate the limit @eq-L is proposed in [@barthelemy2009c] whereas in the isotropic case $\\uu{B}$ writes\n$$\n\\uu{B}=\nB_{nn}\\,\\uv{n}\\otimes\\uv{n}\n+\nB_{mm}\\,\\uv{m}\\otimes\\uv{m}\n+\nB_{\\ell\\ell}\\,\\uv{\\ell}\\otimes\\uv{\\ell}\n$$\nwith\n$$\\begin{aligned}\nB_{nn}&=\\frac{8\\,\\eta\\,(1-\\nu^2)}{3\\,E}\\,\n\\frac{1}{\\mathcal{E}_\\eta}\\label{eq:Bnn}\\\\\nB_{mm}&=\\frac{8\\,\\eta\\,(1-\\nu^2)}{3\\,E}\\,\n\\frac{1-\\eta^2}{\\left(1-(1-\\nu)\\,\\eta^2\\right)\n\\,\\mathcal{E}_\\eta-\\nu\\,\\eta^2\\,\\mathcal{K}_\\eta}\\\\\nB_{\\ell\\ell}&=\\frac{8\\,\\eta\\,(1-\\nu^2)}{3\\,E}\\,\n\\frac{1-\\eta^2}{(1-\\nu-\\eta^2)\\,\\mathcal{E}_\\eta+\\nu\\,\\eta^2\\,\\mathcal{K}_\\eta}\n\\end{aligned}$$\nwhere $\\mathcal{K}_\\eta=\\mathcal{K}(\\sqrt{1-\\eta^2})$ and $\\mathcal{E}_\\eta=\\mathcal{E}(\\sqrt{1-\\eta^2})$\nare the complete elliptic integrals of respectively the first and second kind (see [@abramowitz1972]).\nIf the crack is circular, the components of $\\uu{B}$ become\n$$\nB_{nn}=\\frac{16\\,(1-\\nu^2)}{3\\,\\pi\\,E}\n\\quad\\textrm{;}\\quad\nB_{mm}=B_{\\ell\\ell}=\\frac{B_{nn}}{1-\\nu/2}\n$$\n\n## Application of Hill calculation\n\n```{python}\n#| error: false\n#| warning: false\n\nimport numpy as np\nfrom echoes import *\nimport matplotlib.pyplot as plt\n```\n\n### Definition of the matrix tensor\n\n```{python}\nC = stiff_Enu(1.,0.2) ; print(C)\n```\n\n### Calculation of the crack compliance $\\uuuu{L}=\\lim_{\\omega\\to 0}\\omega\\,\\uuuu{Q}^{-1}$\nNote that in *Echoes* it is necessary to provide an aspect ratio $\\omega$ for the crack even if the crack compliance is actually calculated as a limit (not depending on $\\omega$)\n\n```{python}\nω = 1.e-4\nL = crack_compliance(spheroidal(ω), C) ; print(L)\n```\n\n### Checking the aspect ratio for which $\\omega\\,\\uuuu{Q}^{-1}\\approx \\lim_{\\omega\\to 0}\\omega\\,\\uuuu{Q}^{-1}$ is acceptable\n\n```{python}\n#| label: fig-error\n#| fig-cap: \"Influence of the aspect ratio on the contribution tensor\"\n\ntω = np.logspace(-5,1,20)\ntabδ = []\nfor ω in tω:\n    Q = hill_dual(spheroidal(ω), C)\n    Lω = ω*np.linalg.inv(Q)\n    δL = np.linalg.norm(Lω-L)/np.linalg.norm(L)\n    tabδ.append(δL)\nplt.figure(figsize=(8,3))\nplt.loglog(tω,tabδ,'+-')\nplt.xlabel(r\"$\\omega$\")\nplt.ylabel(r\"$\\frac{||\\mathbb{L}-\\omega\\,\\mathbb{Q}^{-1}||}{||\\mathbb{L}||}$\")\nplt.grid(True,which='both')\nplt.show()\n```\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":true,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","html-math-method":"mathjax","output-file":"Hill_tensor.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.219","bibliography":["biblio.bib"],"link-citations":true,"jupyter":"python3","theme":"journal","code-block-bg":true,"code-block-border-left":"#31BAE9","coce-link":true,"fontsize":"normal"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":true,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":true,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"lualatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","highlight-style":"tango","include-in-header":["config/_preamble.tex","config/_macros.tex"],"output-file":"Hill_tensor.pdf"},"language":{},"metadata":{"block-headings":true,"bibliography":["biblio.bib"],"link-citations":true,"jupyter":"python3","documentclass":"scrreprt"},"extensions":{"book":{}}}}}