{
  "hash": "60f68e3a5c594d8527be098187cc3918",
  "result": {
    "markdown": "::: {.content-visible unless-format=\"pdf\"}\n::: {.hidden}\n$$\n\\newcommand{\\uu}[1]{{\\mathbf{\\boldsymbol{{#1}}}}}\n\\newcommand{\\uuuu}[1]{{\\mathbb{{#1}}}}\n\\newcommand{\\uv}[1]{{\\underline{{#1}}}}\n\\newcommand{\\trans}[1]{{{}^{t}{#1}}}\n\\newcommand{\\sotimes}{{\\stackrel{s}{\\otimes}}}\n\\newcommand{\\norm}[1]{{\\lVert{{#1}}\\rVert}}\n\\newcommand{\\ud}{{\\,\\mathrm{d}}}\n\\DeclareMathOperator{\\arcosh}{arcosh}\n\n\n$$\n:::\n:::\n\n# Hill polarization tensor in elasticity {#sec-hill_elas}\n\nThis section recalls some results about the calculation of the Hill polarization tensors related to a matrix of stiffness $\\mathbb{C}$ and an ellipsoid $\\mathcal{E}_{\\uu{A}}$ of equation\n$$\n\\uv{x}\\in\\mathcal{E}_{\\uu{A}}\n\\quad\\Leftrightarrow\\quad\n\\uv{x}\\cdot(\\trans{\\uu{A}}\\cdot\\uu{A})^{-1}\\cdot\\uv{x}\\leq 1\n$$\nwhere $\\uu{A}$ is an invertible second-order tensor so that $\\trans{\\uu{A}}\\cdot\\uu{A}$ is a positive definite symmetric tensor associated to 3 radii (eigenvalues $a\\geq b \\geq c$ possibly written $\\rho_1 \\geq \\rho_2 \\geq \\rho_3$ for convenience) and 3 angles (orientation of the frame of eigenvectors $\\uv{e}_1, \\uv{e}_2, \\uv{e}_3$)\n$$\n\\trans{\\uu{A}}\\cdot\\uu{A}=a^2 \\uv{e}_1\\otimes\\uv{e}_1 + b^2 \\uv{e}_2\\otimes\\uv{e}_2 + c^2 \\uv{e}_3\\otimes\\uv{e}_3 = \\sum_{i=1}^3 \\rho_i \\uv{e}_i\\otimes\\uv{e}_i\n$${#eq-ellipsoid}\n\n## General expression\n\nA general expression of the elastic polarization tensor is derived in [@willis1977] (see also [@mura1987])\n$$\\begin{aligned}\n\\uuuu{P}(\\uu{A},\\uuuu{C})&=\\frac{1}{4\\pi}\n\\int_{\\norm{\\uv{\\zeta}}=1}\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\\sotimes\n\\Big((\\uu{A}^{-1}\\cdot\\uv{\\zeta})\\cdot\\uuuu{C}\n\\cdot(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\\Big)^{-1}\n\\sotimes(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n\\ud S_\\zeta\\\\\n&=\n\\frac{\\det{\\uu{A}}}{4\\pi}\n\\int_{\\norm{\\uv{\\xi}}=1}\n\\frac{\\uv{\\xi}\\sotimes\n(\\uv{\\xi}\\cdot\\uuuu{C}\n\\cdot\\uv{\\xi})^{-1}\n\\sotimes\\uv{\\xi}}{\\norm{\\uu{A}\\cdot\\uv{\\xi}}^3}\n\\ud S_{\\xi}\n\\end{aligned}$${#eq-Hill}\n\nWhen $\\uuuu{C}$ is arbitrarily anisotropic, it is necessary to resort to numerical cubature to estimate $\\uuuu{P}$ as proposed in [@ghahremani1977], [@gavazzi1990] or [@masson2008]. However in some cases of anisotropy, analytical solutions are available ([@withers1989], [@barthelemy2020]). The case of isotropic matrix is particularly developed in the next section.\n\n## Isotropic matrix\n\nIn this section, the matrix is assumed isotropic so that its stiffness tensor writes by means of a bulk $k$ and shear $\\mu$ or Lamé $\\lambda$ and $\\mu$ moduli or even Young modulus $E$ and Poisson ratio $\\nu$ with $k=\\frac{E}{3(1-2\\nu)}$ and $\\mu=\\frac{E}{2(1+\\nu)}$.\n$$\\begin{aligned}\n\\uuuu{C} =& {} 3k\\uuuu{J}+2\\mu\\uuuu{K} =  3\\lambda\\uuuu{I}+2\\mu\\uuuu{K}\\\\\n & \\quad\\textrm{with}\\quad J_{ijkl}=\\frac{\\delta_{ij}\\delta_{kl}}{3},\nI_{ijkl}=\\frac{\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}}{2}\n\\textrm{ and }\n\\uuuu{K}=\\uuuu{I}-\\uuuu{J}\n\\end{aligned}$${#eq-isoC}\n\nIntroducing @eq-isoC in @eq-Hill leads to after some algebra\n$$\n\\uuuu{P}=\n\\frac{1}{\\lambda+2\\,\\mu}\n\\uuuu{U}\n+\\frac{1}{\\mu}(\\uuuu{V}-\\uuuu{U})\n$$\nwhere the tensors $\\uuuu{U}$ and $\\uuuu{V}$, depending only on the ellipsoidal\ntensor $\\uu{A}$ of [@eq-ellipsoid], are given by (see [@barthelemy2020])\n$$\\begin{aligned}\n\\uuuu{U} &= \\frac{\\det{\\uu{A}}}{4\\pi}\n\\int_{\\norm{\\uv{\\xi}}=1}\n\\frac{\\uv{\\xi}\\otimes\\uv{\\xi}\\otimes\\uv{\\xi}\\otimes\\uv{\\xi}}\n{\\norm{\\uu{A}\\cdot\\uv{\\xi}}^3}\\ud S_{\\xi}\\\\\n&=\n\\frac{1}{4\\pi}\n\\int_{\\norm{\\uv{\\zeta}}=1}\n\\frac{%\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n\\otimes\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n\\otimes\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n\\otimes\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n}{\\norm{\\uu{A}^{-1}\\cdot\\uv{\\zeta}}^4}\n\\ud S_{\\zeta}\n\\end{aligned}$$\nand\n$$\\begin{aligned}\n\\uuuu{V} &= \\frac{\\det{\\uu{A}}}{4\\pi}\n\\int_{\\norm{\\uv{\\xi}}=1}\n\\frac{\\uv{\\xi}\\sotimes\\uu{1}\\sotimes\\uv{\\xi}}\n{\\norm{\\uu{A}\\cdot\\uv{\\xi}}^3}\\ud S_{\\xi}\\\\\n&=\n\\frac{1}{4\\pi}\n\\int_{\\norm{\\uv{\\zeta}}=1}\n\\frac{%\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n\\sotimes\n\\uu{1}\n\\sotimes\n(\\uu{A}^{-1}\\cdot\\uv{\\zeta})\n}{\\norm{\\uu{A}^{-1}\\cdot\\uv{\\zeta}}^2}\n\\ud S_{\\zeta}\n\\end{aligned}$$\nFor an arbitrary ellipsoid defined by @eq-ellipsoid, the components of $\\uuuu{U}$ and $\\uuuu{V}$ write\n$$\\begin{aligned}\nU_{iiii}&=\\frac{3(I_i-\\rho_i^2I_{ii})}{2} \n\\quad\\forall\\, i\\in\\{1,2,3\\}\\\\\nU_{iijj}=U_{ijij}=U_{ijji}&=\\frac{I_j-\\rho_i^2I_{ij}}{2} \n=\\frac{I_i-\\rho_j^2I_{ij}}{2}\n\\quad\\forall\\, i\\neq j\\in\\{1,2,3\\}\n\\end{aligned}$$\nand\n$$\\begin{aligned}\nV_{iiii}&=I_i\\quad\\forall\\, i\\in\\{1,2,3\\}\\\\\nV_{ijij}=V_{ijji}&=\\frac{I_i+I_j}{4}\n\\quad\\forall\\, i\\neq j\\in\\{1,2,3\\}\n\\end{aligned}$$\nwhere the coefficients $I_i$ and $I_{ij}$ are given by\n(note that $I_i$ and $I_{ij}$ are adapted from those provided in\n[@kellogg1929]\nand [@eshelby1957]:\nthey differ by a factor of $4\\pi/3$\nfor $I_{ij}$ with $i\\neq j$ and by $4\\pi$ for the others)\n\n- if $a > b > c$\n    $$\\begin{aligned}\n    I_1&=\\frac{a\\,b\\,c}{(a^2-b^2)\\sqrt{a^2-c^2}}\\,\n    \\left({\\cal F}-{\\cal E}\\right)\\\\\n    I_3&=\\frac{a\\,b\\,c}{(b^2-c^2)\\sqrt{a^2-c^2}}\\,\n    \\left(\\frac{b\\sqrt{a^2-c^2}}{a\\,c}-\n    {\\cal E}\\right)\\\\\n    I_2&=1-I_1-I_3\\\\\n    I_{ij}&=\\frac{I_j-I_i}{\\rho_i^2-\\rho_j^2}\\quad\\forall\\, i\\neq j\\in\\{1,2,3\\}\\\\\n    I_{ii}&=\\frac{1}{3}\\left(\n    \\frac{1}{\\rho_i^2}-\n    \\sum_{j\\neq i}I_{ij} \\right) \n    \\quad\\forall\\, i\\in\\{1,2,3\\}\n    \\end{aligned}$$  \n    where ${\\cal F}={\\cal F}(\\theta,\\kappa)$ and\n    ${\\cal E}={\\cal E}(\\theta,\\kappa)$\n    are respectively the elliptic integrals of the first and second\n    kinds (see [@abramowitz1972]) of amplitude and parameter\n    $$\n    \\theta=\\arcsin{\\sqrt{1-\\frac{c^2}{a^2}}}\n    \\quad;\\quad\n    \\kappa=\\sqrt{\\frac{a^2-b^2}{a^2-c^2}}\n    $$\n- if $a > b = c$ (prolate spheroid)\n    $$\\begin{aligned}\n    I_2=I_3&=a\\,\n    \\frac{a\\sqrt{a^2-c^2}-c^2\\,\\arcosh{(a/c)}}\n    {2\\left(a^2-c^2\\right)^{3/2}}\\\\\n    I_1&=1-2\\,I_3\\\\\n    I_{1i}=I_{i1}&=\\frac{I_i-I_1}{a^2-\\rho_i^2}\\quad\n    \\forall\\, i\\in\\{2,3\\}\\\\\n    I_{ij}&=\\frac{1}{4}\n    \\left(\\frac{1}{c^2}-I_{31} \\right) \n    \\quad\\forall\\, i,j\\in\\{2,3\\}\\\\\n    I_{11}&=\\frac{1}{3}\n    \\left(\\frac{1}{a^2}-2\\,I_{31} \\right)\n    \\end{aligned}$$\n- if $a = b > c$ (oblate spheroid)\n    $$\\begin{aligned}\n    I_1=I_2&=c\\,\n    \\frac{a^2\\,\\arccos{(c/a)}-c\\sqrt{a^2-c^2}}\n    {2\\left(a^2-c^2\\right)^{3/2}}\\\\\n    I_3&=1-2\\,I_1\\\\\n    I_{3i}=I_{i3}&=\\frac{I_3-I_i}{\\rho_i^2-c^2}\\quad\n    \\forall\\, i\\in\\{1,2\\}\\\\\n    I_{ij}&=\\frac{1}{4}\n    \\left(\\frac{1}{a^2}-I_{31} \\right) \n    \\quad\\forall\\, i,j\\in\\{1,2\\}\\\\\n    I_{33}&=\\frac{1}{3}\n    \\left(\\frac{1}{c^2}-2\\,I_{31} \\right)\n    \\end{aligned}$$\n- if $a = b = c$ (sphere)\n    $$\\begin{aligned}\n    I_1=I_2=I_3&=\\frac{1}{3}\\\\\n    I_{ij}&=\\frac{1}{5\\,a^2}\\quad\\forall\\, i,j\\in\\{1,2,3\\}\n    \\end{aligned}$$\n\nIn this last case of spherical inclusion ($\\uu{A}=\\uu{1}$), $\\uuuu{U}$ and $\\uuuu{V}$ are simply decomposed as\n$$\n\\uuuu{U}=\\frac{1}{3}\\uuuu{J}+\\frac{2}{15}\\uuuu{K}\n\\quad\\textrm{ and }\\quad\n\\uuuu{V}=\\frac{1}{3}\\uuuu{I}\n$$\n\n## Case of cracks\n\nThe case of cracks corresponds to ellipsoids for which the smallest radius is very small compared to the two others, in other words the characteristic tensor $\\uu{A}$ @eq-ellipsoid can be written here\n$$\n\\uu{A}=\n\\uv{\\ell}\\otimes\\uv{\\ell}+\n\\eta\\,\\uv{m}\\otimes\\uv{m}+\n\\omega\\,\\uv{n}\\otimes\\uv{n}\n\\quad\\textrm{with}\\quad\n\\eta=\\frac{b}{a}\n\\quad\\textrm{and}\\quad\n\\omega=\\frac{c}{a}\n$$\n\n::: {#fig-crack}\n\n![](images/ellipsoidalcrack){width=50%}\n\nEllipsoidal crack\n:::\n\nIn the case of cracks, it is useful to introduce the second Hill polarization tensor defined as\n$$\n\\uuuu{Q}=\\uuuu{C}-\\uuuu{C}:\\uuuu{P}:\\uuuu{C}\n$$\nand in particular $\\lim_{\\omega\\to 0}\\omega\\,\\uuuu{Q}^{-1}$\nin which it is recalled that $\\uuuu{P}$ and thus $\\uuuu{Q}$ depend on $\\omega$ such that the components $Q_{nijk}$ (with $n$ corresponding to the crack normal) behave as $1/\\omega$ when $\\omega$ tends towards $0$. The analytical expressions of this limit are fully detailed in [@barthelemy2021] which recalls in particular that $\\uuuu{L}$ actually derives from a symmetric second-order tensor $\\uu{B}$ as\n$$\n\\uuuu{L}=\n\\lim_{\\omega\\to 0} \\omega\\,\\uuuu{Q}^{-1}\n=\\frac{3}{4}\\,\\uv{n}\\sotimes\\uu{B}\\sotimes\\uv{n}\n$${#eq-L}\n\nFor an arbitrarly anisotropic matrix, an algorithm allowing to estimate the limit @eq-L is proposed in [@barthelemy2009c] whereas in the isotropic case $\\uu{B}$ writes\n$$\n\\uu{B}=\nB_{nn}\\,\\uv{n}\\otimes\\uv{n}\n+\nB_{mm}\\,\\uv{m}\\otimes\\uv{m}\n+\nB_{\\ell\\ell}\\,\\uv{\\ell}\\otimes\\uv{\\ell}\n$$\nwith\n$$\\begin{aligned}\nB_{nn}&=\\frac{8\\,\\eta\\,(1-\\nu^2)}{3\\,E}\\,\n\\frac{1}{\\mathcal{E}_\\eta}\\label{eq:Bnn}\\\\\nB_{mm}&=\\frac{8\\,\\eta\\,(1-\\nu^2)}{3\\,E}\\,\n\\frac{1-\\eta^2}{\\left(1-(1-\\nu)\\,\\eta^2\\right)\n\\,\\mathcal{E}_\\eta-\\nu\\,\\eta^2\\,\\mathcal{K}_\\eta}\\\\\nB_{\\ell\\ell}&=\\frac{8\\,\\eta\\,(1-\\nu^2)}{3\\,E}\\,\n\\frac{1-\\eta^2}{(1-\\nu-\\eta^2)\\,\\mathcal{E}_\\eta+\\nu\\,\\eta^2\\,\\mathcal{K}_\\eta}\n\\end{aligned}$$\nwhere $\\mathcal{K}_\\eta=\\mathcal{K}(\\sqrt{1-\\eta^2})$ and $\\mathcal{E}_\\eta=\\mathcal{E}(\\sqrt{1-\\eta^2})$\nare the complete elliptic integrals of respectively the first and second kind (see [@abramowitz1972]).\nIf the crack is circular, the components of $\\uu{B}$ become\n$$\nB_{nn}=\\frac{16\\,(1-\\nu^2)}{3\\,\\pi\\,E}\n\\quad\\textrm{;}\\quad\nB_{mm}=B_{\\ell\\ell}=\\frac{B_{nn}}{1-\\nu/2}\n$$\n\n## Application of Hill calculation\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nfrom echoes import *\nimport matplotlib.pyplot as plt\n```\n:::\n\n\n### Definition of the matrix tensor\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nC = stiff_Enu(1.,0.2) ; print(C)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOrder 4 ISO tensor | Param(size=2)=[ 1.66667 0.833333 ] | Angles(size=0)=[ ]\n[ 1.11111 0.277778 0.277778 0 0 0 \n  0.277778 1.11111 0.277778 0 0 0 \n  0.277778 0.277778 1.11111 0 0 0 \n  0 0 0 0.833333 0 0 \n  0 0 0 0 0.833333 0 \n  0 0 0 0 0 0.833333 ]\n\n```\n:::\n:::\n\n\n### Calculation of the crack compliance $\\uuuu{L}=\\lim_{\\omega\\to 0}\\omega\\,\\uuuu{Q}^{-1}$\nNote that in *Echoes* it is necessary to provide an aspect ratio $\\omega$ for the crack even if the crack compliance is actually calculated as a limit (not depending on $\\omega$)\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nω = 1.e-4\nL = crack_compliance(spheroidal(ω), C) ; print(L)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[0.         0.         0.         0.         0.         0.        ]\n [0.         0.         0.         0.         0.         0.        ]\n [0.         0.         1.22230996 0.         0.         0.        ]\n [0.         0.         0.         0.67906109 0.         0.        ]\n [0.         0.         0.         0.         0.67906109 0.        ]\n [0.         0.         0.         0.         0.         0.        ]]\n```\n:::\n:::\n\n\n### Checking the aspect ratio for which $\\omega\\,\\uuuu{Q}^{-1}\\approx \\lim_{\\omega\\to 0}\\omega\\,\\uuuu{Q}^{-1}$ is acceptable\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\ntω = np.logspace(-5,1,20)\ntabδ = []\nfor ω in tω:\n    Q = hill_dual(spheroidal(ω), C)\n    Lω = ω*np.linalg.inv(Q)\n    δL = np.linalg.norm(Lω-L)/np.linalg.norm(L)\n    tabδ.append(δL)\nplt.figure(figsize=(8,3))\nplt.loglog(tω,tabδ,'+-')\nplt.xlabel(r\"$\\omega$\")\nplt.ylabel(r\"$\\frac{||\\mathbb{L}-\\omega\\,\\mathbb{Q}^{-1}||}{||\\mathbb{L}||}$\")\nplt.grid(True,which='both')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Influence of the aspect ratio on the contribution tensor](hill_elas_files/figure-html/fig-error-output-1.png){#fig-error width=687 height=283}\n:::\n:::\n\n\n",
    "supporting": [
      "hill_elas_files"
    ],
    "filters": [],
    "includes": {}
  }
}